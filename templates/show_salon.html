<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Salons</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/show_salon.css') }}">
</head>

<body>
<div class="wrap">

  <div class="top">
    <h2>Registered Salons</h2>
    <div>
      <a class="btn add-btn" href="{{ url_for('register_salon') }}">+ Add New Salon</a>
    </div>
  </div>

  <!-- Navigation Bar -->
  <div class="navbar" style="text-align:center; margin: 20px;">
      <a href="{{ url_for('gender') }}">Home</a>
      <a href="{{ url_for('about') }}" class="active">About</a>
      <a href="{{ url_for('services_categories') }}">Services & Categories</a>
      <a href="{{ url_for('help_page') }}">Contact Us</a>
  </div>

  <!-- SEARCH BOX -->
  <form class="search_box" method="get" action="{{ url_for('show_salons') }}">
    <input type="search" name="search" placeholder="Search by name or address" value="{{ search_query or '' }}">
    <button type="submit">Search</button>
  </form>

  <!-- GRID START -->
  <div class="grid">

    {% for salon in salons %}
    <div class="card">

        {% if salon.image_path %}
            <img src="{{ url_for('static', filename=salon.image_path) }}" alt="{{ salon.name }}">
        {% else %}
            <div class="no-img">No Image</div>
        {% endif %}

        <h3>{{ salon.name }}</h3>
        <p class="muted">ğŸ“ {{ salon.address }}</p>
        <p class="muted">ğŸ“ {{ salon.contact }}</p>

        {% if salon.price %}
          <p class="price">ğŸ’° {{ salon.price }}</p>
        {% endif %}

        <p class="rating">
          â­ Rating:
          {% if salon.rating_count > 0 %}
            {{ (salon.rating_total / salon.rating_count) | round(1) }} / 5
          {% else %}
            0 / 5
          {% endif %}
        </p>

        <!-- Rating Form -->
        <form action="{{ url_for('rate_salon', salon_id=salon.id) }}" method="POST" class="rating-form">
          <label for="rating-{{ salon.id }}">Rate this salon:</label>
          <select name="rating" id="rating-{{ salon.id }}" required>
            <option value="">--Select--</option>
            <option value="1">â­ 1</option>
            <option value="2">â­ 2</option>
            <option value="3">â­ 3</option>
            <option value="4">â­ 4</option>
            <option value="5">â­ 5</option>
          </select>
          <button type="submit" class="rate-btn">Submit</button>
        </form>

        <!-- Salon Status -->
        <p>
          {% if salon.status == 'ON' %}
              <span style="color: lightgreen; font-weight:600;">ğŸŸ¢ Salon is OPEN</span>
          {% else %}
              <span style="color: red; font-weight:600;">ğŸ”´ Salon is CLOSED</span>
          {% endif %}
        </p>

        <!-- BOOK SLOT -->
        {% if salon.status == 'ON' %}
            <a class="btn book-btn" href="{{ url_for('book_slot_for_salon', salon_id=salon.id) }}">Book Slot</a>
        {% else %}
            <button class="btn book-btn" style="background: rgba(58, 241, 2, 0.856);" disabled>Salon Closed</button>
        {% endif %}

        <!-- OWNER: TOGGLE -->
        {% if username == salon.owner_username %}
            <button onclick="openPassKeyPopup({{ salon.id }})"
        class="toggle-btn">
    Toggle ON / OFF
</button>

        {% endif %}

    </div>
    {% else %}
      <p>No salons found.</p>
    {% endfor %}

  </div> <!-- GRID END -->

</div> <!-- WRAP END -->


<!-- PASSKEY POPUP -->
<div id="passKeyModal">
    <form id="passKeyForm" method="POST">
        <h3 style="margin-bottom: 10px; text-align:center;">Enter Pass Key</h3>

        <input type="password" 
               name="pass_key" 
               placeholder="Pass Key" 
               required>

        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</div>


<script>
  //used for location also 
navigator.geolocation.getCurrentPosition(pos => {
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;
    window.location = `/recommend?lat=${lat}&lon=${lon}&category=hair`;
});





function openPassKeyPopup(salon_id) {
    const modal = document.getElementById("passKeyModal");
    const form = document.getElementById("passKeyForm");
    form.action = "/toggle_salon/" + salon_id;
    modal.style.display = "flex";
}

window.onclick = function(event) {
    const modal = document.getElementById("passKeyModal");
    if (event.target === modal) {
        modal.style.display = "none";
    }
}
</script>


<!-- FOOTER OUTSIDE WRAP (FULL WIDTH) -->
<div class="footer" id="footer">
    <div class="footer-top">

        <div class="footer-column">
            <h4>About SalonFinder</h4>
            <a href="#">Who We Are</a>
            <a href="#">Blog</a>
            <a href="#">Work With Us</a>
            <a href="#">Report Issue</a>
            <a href="{{ url_for('contact_us') }}">Contact Us</a>
        </div>

        <div class="footer-column">
            <h4>SalonVerse</h4>
            <a href="#">SalonFinder</a>
            <a href="#">BeautyVerse</a>
            <a href="#">HairCare Hub</a>
            <a href="#">GlowUp</a>
        </div>

        <div class="footer-column">
            <h4>Learn More</h4>
            <a href="{{ url_for('cancellation') }}">Cancellation & Refund Policy</a>
            <a href="{{ url_for('privacy') }}">Privacy Policy</a>
            <a href="{{ url_for('term') }}">Terms & Conditions</a>
        </div>

        <div class="footer-column">
            <h4>Social Links</h4>
            <div class="social-icons">
                <i class="fab fa-linkedin"></i>
                <i class="fab fa-instagram"></i>
                <i class="fab fa-x-twitter"></i>
                <i class="fab fa-youtube"></i>
                <i class="fab fa-facebook"></i>
            </div>

            <div class="app-links">
                <img src="https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg" alt="App Store">
                <img src="https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg" alt="Play Store">
            </div>
        </div>

        <div class="footer-column">
            <div class="dropdowns">
                <select>
                    <option selected>ğŸ‡®ğŸ‡³ India</option>
                    <option>ğŸ‡ºğŸ‡¸ United States</option>
                    <option>ğŸ‡¬ğŸ‡§ United Kingdom</option>
                    <option>ğŸ‡©ğŸ‡ª Germany</option>
                    <option>ğŸ‡«ğŸ‡· France</option>
                    <option>ğŸ‡¯ğŸ‡µ Japan</option>
                    <option>ğŸ‡¨ğŸ‡¦ Canada</option>
                    <option>ğŸ‡¦ğŸ‡º Australia</option>
                </select>

                <select>
                    <option selected>English</option>
                    <option>Deutsch</option>
                    <option>FranÃ§ais</option>
                    <option>æ—¥æœ¬èª</option>
                    <option>EspaÃ±ol</option>
                    <option>à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                </select>
            </div>
        </div>
    </div>

    <div class="footer-bottom">
        Â© 2025 Glooraâ„¢. All rights reserved. Use of this platform constitutes acceptance of our Terms, Privacy Policy, and Cookie Policy.
    </div>
</div>

</body>
</html>
